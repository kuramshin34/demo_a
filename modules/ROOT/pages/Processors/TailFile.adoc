= TailFile 2.2.0

"Tails" a file, or a list of files, ingesting data from the file as it is written to the file. The file is expected to be textual. Data is ingested only when a new line is encountered (carriage return or new-line character or combination). If the file to tail is periodically "rolled over", as is generally the case with log files, an optional Rolling Filename Pattern can be used to retrieve data from files that have rolled over, even if the rollover occurred while NiFi was not running (provided that the data still exists upon restart of NiFi). It is generally advisable to set the Run Schedule to a few seconds, rather than running with the default value of 0 secs, as this Processor will consume a lot of resources if scheduled very aggressively. At this time, this Processor does not support ingesting files that have been compressed when 'rolled over'.

[horizontal]
*Tags* (Ключевые слова):
file, log, source, tail, text
[horizontal]
*Input Requirement* (Требования к вводу данных):
FORBIDDEN
[horizontal]
*Supports Sensitive Dynamic* (Поддержка динамически изменяемых параметров, которые могут содержать конфиденциальную информацию):
 False (Нет) 



== Properties (Свойства)


.*Tail-Mode*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Tailing mode (Режим хвоста)

[horizontal]
*DESCRIPTION (Описание):*:: Режим использования: одиночный файл будет следить только за одним файлом, множественные файлы будут искать список файлов. В режиме Множественные требуется 'Базовый каталог'.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Single file (Одиночный файл): В этом режиме только указанный в свойстве 'Files to tail' файл будет отслеживаться процессором. В этом режиме файл может не существовать при запуске процессора. 

* Multiple files (Множественные файлы): В этом режиме свойство 'Files to tail' принимает регулярное выражение, и процессор будет искать файлы в 'Базовом каталоге', чтобы перечислить файлы для отслеживания процессором. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*File To Tail*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: File(s) to Tail (Файлы для отслеживания)

[horizontal]
*DESCRIPTION (Описание):*:: Путь к файлу, который нужно отслеживать в режиме одиночного файла. Если используется многофайловый режим, регулярное выражение для поиска файлов в базовой директории. В случае установки рекурсивности на 'true', регулярное выражение будет использовано для сопоставления пути, начиная с базовой директории (см. дополнительные сведения о примерах).


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Rolling Filename Pattern
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Rolling Filename Pattern (Шаблон имени файла)

[horizontal]
*DESCRIPTION (Описание):*:: Если файл, который нужно отслеживать, "перекатывается" как это бывает с лог-файлами, этот шаблон имени файла будет использоваться для идентификации перекатанных файлов, что позволит NiFi, если он перезапустится, продолжить отслеживание, даже если файл был перекатан. Этот шаблон поддерживает символы-джокеры * и ?, а также использует обозначение ${filename} для указания шаблона на основе имени файла (без расширения), и предположит, что перекатанные файлы находятся в той же директории, что и отслеживаемый файл. Один и тот же глобус-шаблон будет использоваться для всех файлов.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Post-Rollover Tail Period
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Post-Rollover Tail Period (Период после перезаписи хвоста)

[horizontal]
*DESCRIPTION (Описание):*:: Когда файл отправляется на перезапись, процессор будет продолжать читать его содержимое в течение этого времени, пока оно не изменилось. Это позволяет другому процессу отправить новый файл и вывести все буферизованные данные. Следует отметить, что при установке этого значения и последующей перезаписи файла, новый файл не будет читаться до тех пор, пока старый файл не останется неизменным в течение заданного времени. Кроме того, при использовании этой возможности для избежания дублирования данных, период должен быть установлен больше расписания выполнения процессора, и процессор не должен быть остановлен после перезаписи файла, который в данный момент читается, и до полной потребности в данных. В противном случае могут возникнуть дубликаты данных, так как весь файл может быть записан как содержимое одного потока FlowFile.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Tail-Base-Directory
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Base directory (Базовая директория)

[horizontal]
*DESCRIPTION (Описание):*:: Base directory used to look for files to tail. This property is required when using Multifile mode.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Initial Start Position*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Initial Start Position (Начальная позиция запуска)

[horizontal]
*DESCRIPTION (Описание):*:: Когда процессор впервые начинает обрабатывать данные, это свойство указывает, где процессор должен начать читать данные. После того как данные были проинжестированы из файла, процессор будет продолжать с последней точки, с которой он получил данные.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Beginning of Time (Начало времени): Начните с самых старых данных, соответствующих шаблону имени файла, и затем начните читать с файла для продолжения. 

* Beginning of File (Начало файла): Начните с начала файла для продолжения. Не вводите никаких данных, которые уже были перекатами. 

* Current Time (Текущее время): Начните с данных в конце файла для продолжения. Не вводите никаких данных, которые уже были перекатами или любых данных в файле для продолжения, которые уже были записаны. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*File Location*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: State Location (Состояние расположения)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, где находится состояние локально или в кластере, чтобы состояние можно было хранить соответствующим образом, гарантируя отсутствие дублирования данных при перезапуске NiFi


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Local (Локально): Состояние хранится локально. Каждый узел в кластере будет отслеживать разные файлы. 

* Remote (Удаленный): Состояние расположено на удаленном ресурсе. Этот процессор будет хранить состояние в кластере, что позволит его запустить только на основном узле, и новый основной узел сможет продолжить работу с того места, где остановился предыдущий. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Tailfile-Recursive-Lookup*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Recursive lookup (Рекурсивный поиск)

[horizontal]
*DESCRIPTION (Описание):*:: При использовании режима с несколькими файлами это свойство определяет, должны ли файлы перечисляться рекурсивно в базовой директории или нет.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Tailfile-Lookup-Frequency
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Lookup frequency (Поиск частоты)

[horizontal]
*DESCRIPTION (Описание):*:: Используется только в режиме нескольких файлов. Указывает минимальный интервал ожидания перед повторным просмотром файлов для отслеживания.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Tailfile-Maximum-Age
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum age (Максимальный возраст)

[horizontal]
*DESCRIPTION (Описание):*:: Используется только в режиме нескольких файлов. Указывает необходимый минимальный срок, считая, что в файле больше не будут добавляться новые сообщения относительно даты его последнего изменения. Это значение не должно быть слишком низким, чтобы избежать дублирования данных в случае добавления новых сообщений реже.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Reread-On-Nul
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Reread when NUL encountered (Перечитать при встрече с символом NUL)

[horizontal]
*DESCRIPTION (Описание):*:: Если этот параметр установлен на 'true', при встрече с символом NUL процессор перейдет в режим ожидания и попытается прочитать ту же часть снова позже. (Примечание: Ожидание может задержать обработку других файлов, отслеживаемых этим процессором, не только тот, который содержит символ NUL.) Целью этого флага является обеспечение возможности обработки случаев, когда чтение файла может временно возвращать значения NUL. Например, NFS может отправлять содержимое файлов не в порядке. В этом случае отсутствующие части временно заменяются символами NUL. ВНИМАНИЕ! Если файл содержит легитимные значения NUL, установка этого флага приводит к бесконечному ожиданию процессора. Из-за этого пользователи должны отказаться от использования этой функции, если смогут, и избегать размещения целевого файла на файловой системе, где чтение может быть ненадежным.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Line Start Pattern
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Line Start Pattern (Шаблон начала строки)

[horizontal]
*DESCRIPTION (Описание):*:: Регулярное выражение для сопоставления с началом строки журнала. Если указано, любая строка, которая соответствует выражению, и любые последующие строки будут буферизованы до тех пор, пока другая строка не соответствует выражению. В этом мы избегаем разбиения многострочных сообщений в файле. Это предполагает, что данные находятся в формате UTF-8.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Pre-Allocated-Buffer-Size*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Pre-Allocated Buffer Size (Предварительно выделенный размер буфера)

[horizontal]
*DESCRIPTION (Описание):*:: Устанавливает количество памяти, которое предварительно выделяется для каждого хвостового файла.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Max Buffer Size*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Max Buffer Size (Максимальный размер буфера)

[horizontal]
*DESCRIPTION (Описание):*:: При использовании шаблона начала строки могут возникнуть ситуации, когда данные в файле, который отслеживается, никогда не соответствуют регулярному выражению. Это приведет к тому, что процессор будет буферизовать все данные из отслеживаемого файла, что может быстро исчерпать кучу. Чтобы этого избежать, процессор будет буферизовать только до этого количества данных перед очисткой буфера, даже если это означает поглощение частичных данных из файла.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************




=== Управление состоянием

[cols="1a,2a",options="header",]
|===
|Масштаб |Описание

|
LOCAL

CLUSTER

|Stores state about where in the Tailed File it left off so that on restart it does not have to duplicate data. State is stored either local or clustered depend on the <File Location> property.
|===





=== Ограничения

[cols="1a,2a",options="header",]
|===
|Требуемые права |Объяснение

|
|Provides operator the ability to read from any file that NiFi has access to.

|===



=== Relationships (Связи)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`success`
|All FlowFiles are routed to this Relationship.

|===





=== Writes Attributes (Записываемые атрибуты)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`tailfile.original.path`
|Path of the original file the flow file comes from.

|===







