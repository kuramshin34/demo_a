= ListAzureBlobStorage_v12 2.2.0

Перечисляет большие двоичные объекты в контейнере Azure Blob Storage. Детали перечисления прикрепляются к пустому FlowFile для использования с FetchAzureBlobStorage. Этот процессор предназначен для выполнения только на основном узле кластера. Если основной узел изменяется, новый основной узел продолжит работу с места остановки предыдущего узла без дублирования всех данных. Процессор использует библиотеку клиента Azure Blob Storage версии 12.

[horizontal]
*Tags* (Ключевые слова):
azure, blob, cloud, microsoft, storage
[horizontal]
*Input Requirement* (Требования к вводу данных):
FORBIDDEN
[horizontal]
*Supports Sensitive Dynamic* (Поддержка динамически изменяемых параметров, которые могут содержать конфиденциальную информацию):
 False (Нет) 



== Properties (Свойства)


.*Storage-Credentials-Service*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Storage Credentials (Хранилище учетных данных)

[horizontal]
*DESCRIPTION (Описание):*:: Контроллер сервис, используемый для получения учетных данных Azure Blob Storage.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Container-Name*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Container Name (Контейнер)

[horizontal]
*DESCRIPTION (Описание):*:: Имя контейнера Azure хранения. В случае PutAzureBlobStorage процессора, контейнер может быть создан, если он не существует.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Blob-Name-Prefix
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Blob Name Prefix (Имя префикса бобла)

[horizontal]
*DESCRIPTION (Описание):*:: Поисковый префикс для списка


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Record-Writer
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Record Writer (Записыватель записей)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает записыватель записей для создания списка. Если не указан, будет создан один FlowFile для каждой перечисленной сущности. Если указать записыватель записей, все сущности будут записаны в один FlowFile вместо добавления атрибутов к отдельным FlowFiles.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Listing-Strategy*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Listing Strategy (Стратегия перечисления)

[horizontal]
*DESCRIPTION (Описание):*:: Укажите, как определить новые или обновленные сущности. Подробнее о каждой стратегии см. в их описаниях.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Tracking Timestamps (Отслеживание временных меток): Эта стратегия отслеживает последнюю временную метку перечисленной сущности для определения новых или обновленных сущностей. Поскольку она отслеживает только несколько временных меток, она может эффективно управлять состоянием перечисления. Однако любая новая или обновленная сущность с временной меткой старше отслеживаемой последней временной метки не будет выбрана этой стратегией. Например, такая ситуация может возникнуть в файловой системе, если файл с устаревшей временной меткой скопирован или перемещен в целевую директорию без обновления его последней модификации. Также та стратегия может пропустить файлы при одновременной записи нескольких поддиректорий, когда перечисление все еще выполняется. 

* Tracking Entities (Отслеживание сущностей): Эта стратегия отслеживает информацию обо всех перечисленных сущностях в пределах последнего 'Entity Tracking Time Window' для определения новых или обновленных сущностей. Эта стратегия может выбрать сущности с устаревшей временной меткой, которые были пропущены стратегией 'Tracking Timestamps'. Работает даже при одновременной записи нескольких поддиректорий, когда перечисление все еще выполняется. Однако требует дополнительного сервиса контроллера DistributedMapCache и использует больше памяти JVM. Подробнее о работе свойства 'Entity Tracking Time Window' см. 

* No Tracking (Без отслеживания): Эта стратегия перечисляет сущность без какого-либо отслеживания. Одна и та же сущность будет перечисляться каждый раз при выполнении этого процессора. Рекомендуется изменить значение默认ного расписания запуска. Любые свойства, связанные с сохранением состояния, будут игнорироваться. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Et-State-Cache
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Entity Tracking State Cache (Состояние кэша отслеживания сущностей)

[horizontal]
*DESCRIPTION (Описание):*:: Перечисленные сущности хранятся в указанном хранилище кэша, что позволяет этому процессору возобновить перечисление после перезапуска NiFi или изменения основного узла. Стратегия 'Отслеживание сущностей' требует отслеживания информации обо всех перечисленных сущностях в течение последнего 'Окна времени отслеживания'. Для поддержки большого количества сущностей стратегия использует DistributedMapCache вместо управляемого состояния. Формат ключа кэша имеет вид 'ListedEntities::{processorId}(::{nodeId})'. Если отслеживаются перечисленные сущности на узле, то к ключу добавляется необязательная часть '::{nodeId}' для управления состоянием отдельно. Например, глобальный ключ кэша = 'ListedEntities::8dda2321-0164-1000-50fa-3042fe7d6a7b', ключ кэша для узла = 'ListedEntities::8dda2321-0164-1000-50fa-3042fe7d6a7b::nifi-node3' Содержимое сжатой JSON строки хранится в кэше. Ключ будет удален, когда изменится конфигурация целевого перечисления. Используется стратегией 'Отслеживание сущностей'.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Et-Time-Window
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Entity Tracking Time Window (Временное окно отслеживания сущности)

[horizontal]
*DESCRIPTION (Описание):*:: Укажите, как долго этот процессор должен отслеживать уже занесенные в список сущности. Стратегия 'Отслеживание сущностей' может выбирать любую сущность, временная метка которой находится внутри указанного временного окна. Например, если установлено значение '30 минут', то любое существование со временной меткой в течение последних 30 минут будет целью занесения при выполнении этого процессора. Занесенная сущность считается 'новой/обновленной', и поток данных (FlowFile) испускается, если выполняется одно из следующих условий: 1. не существует в уже занесенных сущностях, 2. имеет более новую временную метку, чем кэшированная сущность, 3. имеет отличный размер от кэшированной сущности. Если временная метка кэшированной сущности становится старше указанного временного окна, эта сущность будет удалена из кэшированных уже занесенных сущностей. Используется стратегией 'Отслеживание сущностей'.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Et-Initial-Listing-Target
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Entity Tracking Initial Listing Target (Целевая сущность для начального списка отслеживания)

[horizontal]
*DESCRIPTION (Описание):*:: Укажите, как следует обрабатывать начальный список. Используется стратегией 'Отслеживание Сущностей'.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Tracking Time Window (Окно отслеживания времени): Игнорировать сущности, имеющие временную метку старше указанного 'Окна отслеживания времени' при начальной активности списка. 

* All Available (Все доступные): Независимо от временной метки сущностей, все существующие сущности будут перечислены при начальной активности списка. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Minimum File Age*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Minimum File Age (Минимальный возраст файла)

[horizontal]
*DESCRIPTION (Описание):*:: Минимальный возраст, который файл должен иметь для того, чтобы быть извлеченным; любой файл моложе этого количества времени (согласно дате последнего изменения) будет проигнорирован


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Maximum File Age
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum File Age (Максимальный возраст файла)

[horizontal]
*DESCRIPTION (Описание):*:: Максимальный возраст, который должен иметь файл для его извлечения; любые файлы старше этого времени (согласно дате последнего изменения) будут игнорироваться


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Minimum File Size*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Minimum File Size (Минимальный размер файла)

[horizontal]
*DESCRIPTION (Описание):*:: The minimum size that a file must be in order to be pulled


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Maximum File Size
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum File Size (Максимальный размер файла)

[horizontal]
*DESCRIPTION (Описание):*:: The maximum size that a file can be in order to be pulled (Максимальный размер, который файл может иметь для извлечения)


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Proxy-Configuration-Service
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Proxy Configuration Service (Сервис конфигурации прокси)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает сервис контроллера прокси-серверов для проксирования сетевых запросов. Поддерживаемые прокси: SOCKS, HTTP В случае использования SOCKS, не гарантируется, что выбранная версия SOCKS будет использоваться процессором.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************




=== Управление состоянием

[cols="1a,2a",options="header",]
|===
|Масштаб |Описание

|
CLUSTER

|После выполнения перечисления больших двоичных объектов временная метка самого нового большого двоичного объекта сохраняется, если используется стратегия перечисления 'Tracking Timestamps' (по умолчанию). Это позволяет процессору перечислять только те большие двоичные объекты, которые были добавлены или изменены после этой даты при следующем запуске процессора. Состояние хранится в кластере, что позволяет выполнять процессор только на основном узле и если выбирается новый основной узел, новый узел может продолжить работу с места остановки предыдущего узла без дублирования данных.
|===







=== Relationships (Связи)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`success`
|Все FlowFiles, полученные на входе, направляются в success

|===





=== Writes Attributes (Записываемые атрибуты)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`azure.container`
|Имя контейнера Azure Blob Storage

|`azure.blobname`
|Имя большого двоичного объекта на Azure Blob Storage

|`azure.primaryUri`
|Основное расположение большого двоичного объекта

|`azure.etag`
|ETag большого двоичного объекта

|`azure.blobtype`
|Тип большого двоичного объекта (либо BlockBlob, PageBlob, либо AppendBlob)

|`mime.type`
|MIME-тип содержимого

|`lang`
|Код языка для содержимого

|`azure.timestamp`
|Временная метка большого двоичного объекта

|`azure.length`
|Длина большого двоичного объекта

|===







=== Смотрите также


* xref:Processors/CopyAzureBlobStorage_v12.adoc[CopyAzureBlobStorage_v12]

* xref:Processors/DeleteAzureBlobStorage_v12.adoc[DeleteAzureBlobStorage_v12]

* xref:Processors/FetchAzureBlobStorage_v12.adoc[FetchAzureBlobStorage_v12]

* xref:Processors/PutAzureBlobStorage_v12.adoc[PutAzureBlobStorage_v12]


