= ConsumeSlack 2.2.0

Извлекает сообщения из одного или нескольких настроенных каналов Slack. Сообщения выводятся в формате JSON. Подробнее см. раздел 'Использование / Дополнительные сведения' для получения информации о том, как настроить этот процессор и включить его для извлечения сообщений из Slack.

[horizontal]
*Tags* (Ключевые слова):
conversation, conversation.history, slack, social media, team, text, unstructured
[horizontal]
*Input Requirement* (Требования к вводу данных):
FORBIDDEN
[horizontal]
*Supports Sensitive Dynamic* (Поддержка динамически изменяемых параметров, которые могут содержать конфиденциальную информацию):
 False (Нет) 



== Properties (Свойства)


.*Channels*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Channels (Каналы)

[horizontal]
*DESCRIPTION (Описание):*:: Список Slack-каналов, из которых будут получены сообщения. Каждый элемент списка может быть либо идентификатором канала, например C0L9VCD47, либо именем канала, начинающимся с символа #, например #general. Если вместо идентификатора канала указан его имя, то для разрешения идентификатора канала токен доступа должен быть предоставлен с правом channels:read. См. дополнительные сведения о процессоре для информации о том, как найти идентификатор канала.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Access Token*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Access Token (Маркер доступа)

[horizontal]
*DESCRIPTION (Описание):*:: OAuth Access Token, используемый для аутентификации и авторизации запроса Slack, отправленного через NiFi. Это может быть пользовательский токен или бот-токен. Он должен иметь область доступа channels:history, groups:history, im:history, или mpim:history в зависимости от типа используемого разговора.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  True (Да) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Reply Monitor Window*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Reply Monitor Window (Период отслеживания ответов)

[horizontal]
*DESCRIPTION (Описание):*:: После потребления всех сообщений в заданном канале, этот процессор периодически опрашивает все "пересланные сообщения", то есть ответы, временная метка которых находится между текущим временем и этим количеством времени в прошлом для проверки наличия каких-либо новых ответов. Установка этого значения на большее значение может привести к дополнительному использованию ресурсов и, возможно, ограничению скорости. Однако если пользователь ответит на старый пересланный, начатый вне этого окна, ответ может не быть захвачен.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Reply Monitor Frequency*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Reply Monitor Frequency (Частота мониторинга ответов)

[horizontal]
*DESCRIPTION (Описание):*:: После потребления всех сообщений в заданном канале, этот процессор периодически опрашивает все "последовательные сообщения", то есть ответы, временная метка которых попадает между текущим временем и количеством времени, указанным свойством <Reply Monitor Window>. Это свойство определяет, как часто они опрашиваются. Установка значения на более короткое время может привести к захвату ответов на сообщения быстрее, что обеспечит меньшую задержку. Однако это также приведет к дополнительному использованию ресурсов и может вызвать срабатывание ограничения скорости.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Batch Size*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Batch Size (Максимальное количество сообщений для получения в одном запросе к Slack. Весь ответ будет считан в память, поэтому важно учитывать это при настройке этого значения.)

[horizontal]
*DESCRIPTION (Описание):*:: The maximum number of messages to retrieve in a single request to Slack. The entire response will be parsed into memory, so it is important that this be kept in mind when setting this value.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Resolve Usernames*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Resolve Usernames (Резолвить пользовательские имена)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, должны ли идентификаторы пользователей разрешаться на пользовательские имена. По умолчанию Slack сообщения предоставляют идентификатор пользователя, например U0123456789, но не имя пользователя, такое как NiFiUser. Имя пользователя может быть разрешено, но это может потребовать дополнительных вызовов к Slack API и требует, чтобы используемый токен имел право доступа users:read. Если установлено значение true, имена пользователей будут разрешаться с политикой лучшего усилия: если имя пользователя не может быть получено, оно будет пропущено. Также обратите внимание, что при получении имени пользователя поле <username> сообщения заполняется, и поле <text> обновляется так, чтобы любое упоминание выводилось как "Hi @user" вместо "Hi <@U1234567>".


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true (истина)

* false (ложь)


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Include Message Blocks*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Include Message Blocks (Включать блоки сообщений)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, должен ли выходной JSON включать значение поля 'blocks' для каждого Slack сообщения. Это поле включает информацию о отдельных частях сообщения, отформатированных с использованием разноцветного текста. Это может быть полезно, например, для анализа. Однако часто оно занимает значительную долю данных, и поэтому может быть установлено в null, если это не нужно вам.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Include Null Fields*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Include Null Fields (Включать поля со значениями null)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, должны ли включаться в выходной JSON поля, которые имеют значение null. Если true, любое поле в Slack Message, имеющее значение null, будет включено в JSON с значением null. Если false, ключ исключается из выходного JSON полностью. Исключение значений null приводит к меньшим сообщениям, которые обычно обрабатываются более эффективно, но включение значений может предоставить лучшее понимание формата, особенно для схемы вывода.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************




=== Управление состоянием

[cols="1a,2a",options="header",]
|===
|Масштаб |Описание

|
CLUSTER

|Поддерживает карту идентификаторов Slack-каналов к временной метке последнего полученного сообщения для этого канала. Это позволяет процессору извлекать только те сообщения, которые были опубликованы с момента последнего запуска процессора. Состояние хранится в кластере, чтобы при изменении главного узла новый узел продолжил работу с того места, где остановился предыдущий.
|===







=== Relationships (Связи)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`success`
|Успешно полученные сообщения Slack будут направлены по этому отношению

|===





=== Writes Attributes (Записываемые атрибуты)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`slack.channel.id`
|Идентификатор Slack-канала, из которого были получены сообщения

|`slack.message.count`
|Количество сообщений Slack, включённых в FlowFile

|`mime.type`
|Устанавливается как application/json, так как вывод всегда будет в формате JSON

|===







=== Смотрите также


* xref:Processors/ListenSlack.adoc[ListenSlack]


