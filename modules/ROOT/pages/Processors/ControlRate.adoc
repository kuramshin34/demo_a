= ControlRate 2.2.0

Контролирует скорость передачи данных в последующие процессоры. Если вы настроите очень маленький временной интервал, то точность ограничения снижается. Точность можно улучшить, уменьшив продолжительность паузы, что потребует больше заданий для процессора.

[horizontal]
*Tags* (Ключевые слова):
скорость, контроль скорости, ограничение, пропускная способность
[horizontal]
*Input Requirement* (Требования к вводу данных):
REQUIRED
[horizontal]
*Supports Sensitive Dynamic* (Поддержка динамически изменяемых параметров, которые могут содержать конфиденциальную информацию):
 False (Нет) 



== Properties (Свойства)


.*Rate Control Criteria*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Rate Control Criteria (Критерии управления скоростью)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает критерии, используемые для контроля пропускной способности. Изменение этого значения сбрасывает счетчики скорости.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* data rate (скорость данных): Скорость контролируется подсчетом переданных байт в единицу времени. 

* flowfile count (количество flow файлов): Скорость контролируется подсчетом переданных FlowFiles в единицу времени 

* attribute value (значение атрибута): Скорость контролируется накоплением значения указанного атрибута, переданного в единицу времени 

* data rate or flowfile count (скорость данных или количество flow файлов): Скорость контролируется подсчетом байт и FlowFiles, переданных в единицу времени; если выполнено любое из пороговых значений, применяется ограничение скорости 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Time Duration*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Time Duration (Временной интервал)

[horizontal]
*DESCRIPTION (Описание):*:: Количество времени, к которому относится Максимальная скорость. Изменение этого значения сбрасывает счетчики скорости.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Maximum Rate
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum Rate (Максимальная скорость)

[horizontal]
*DESCRIPTION (Описание):*:: Максимальная скорость, при которой данные должны проходить через этот процессор. Формат этого свойства ожидается быть положительным целым числом или Размером Данных (например, '1 MB'), если критерии управления скоростью установлены на 'скорость данных'.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Maximum Data Rate
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum Data Rate (Максимальная скорость передачи данных)

[horizontal]
*DESCRIPTION (Описание):*:: Максимальная скорость, при которой данные должны проходить через этот процессор. Формат этого свойства ожидается быть размером данных (например, '1 MB'), представляющим количество байт в единицу времени.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Maximum Flowfile Rate
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Maximum FlowFile Rate (Максимальная скорость передачи FlowFiles)

[horizontal]
*DESCRIPTION (Описание):*:: Максимальная скорость, при которой FlowFiles должны проходить через этот процессор. Формат этого свойства ожидается быть положительным целым числом, представляющим количество FlowFiles в единицу времени


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Rate Exceeded Strategy*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Rate Exceeded Strategy (Стратегия превышения скорости)

[horizontal]
*DESCRIPTION (Описание):*:: Specifies how to handle an incoming FlowFile when the maximum data rate has been exceeded.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Hold FlowFile (Удерживать FlowFile): The FlowFile will be held in its input queue until the rate of data has fallen below the configured maximum and will then be allowed through. 

* Route to 'rate exceeded' (Маршрутизация в 'превышение скорости'): The FlowFile will be routed to the 'rate exceeded' Relationship. 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Rate Controlled Attribute
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Rate Controlled Attribute (Контролируемое атрибутивное значение)

[horizontal]
*DESCRIPTION (Описание):*:: Имя атрибута, значения которого накапливаются к скорости ограничения, если установлены критерии контроля скорости. Значение этого атрибута должно быть положительным целым числом, иначе поток будет направлен в сбой. Это значение игнорируется, если критерии контроля скорости не установлены на 'attribute value'. Изменение этого значения сбрасывает счетчики скорости.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Grouping Attribute
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Grouping Attribute (Группирующий атрибут)

[horizontal]
*DESCRIPTION (Описание):*:: По умолчанию для всех FlowFiles используется один "throttle". Если это значение указано, то для каждого значения, указанного атрибутом с таким именем, используется отдельный throttle. Изменение этого значения сбрасывает счетчики скорости.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************










=== Relationships (Связи)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`success`
|FlowFiles передаются в это отношение при нормальных условиях

|`failure`
|Если FlowFiles не содержат необходимого атрибута Rate Controlled или атрибут имеет неправильный формат, они будут направлены в это отношение.

|===







== Варианты использования
:sectnums:



=== Ограничить скорость передачи данных в систему downstream с небольшими или отсутствующими всплесками


NOTE: 



Ключевые слова::
ограничение
лимит
замедлить
скорость данных



.Конфигурация
====
Установите "Rate Control Criteria" в `data rate`.
Установите свойство "Time Duration" на `1 sec`.
Настройте свойство "Maximum Rate", чтобы указать, сколько данных должно проходить каждую секунду.

Например, для разрешения 8 MB в секунду установите "Maximum Rate" в `8 MB`.
====


=== Ограничить скорость передачи FlowFiles в систему downstream с небольшими или отсутствующими всплесками


NOTE: 



Ключевые слова::
ограничение
лимит
замедлить
скорость flowfile



.Конфигурация
====
Установите "Rate Control Criteria" в `flowfile count`.
Установите свойство "Time Duration" на `1 sec`.
Настройте свойство "Maximum Rate", чтобы указать, сколько FlowFiles должно проходить каждую секунду.

Например, для разрешения 100 FlowFiles в секунду установите "Maximum Rate" в `100`.
====


=== Отклонять запросы, которые превышают определенную скорость с небольшими или отсутствующими всплесками


NOTE: 



Ключевые слова::
ограничение
лимит
замедлить
скорость запроса



.Конфигурация
====
Установите "Rate Control Criteria" в `flowfile count`.
Установите свойство "Time Duration" на `1 sec`.
Настройте свойство "Rate Exceeded Strategy", чтобы указать `Route to 'rate exceeded'`.
Настройте свойство "Maximum Rate", чтобы указать, сколько запросов должно проходить каждую секунду.

Например, для разрешения 100 запросов в секунду установите "Maximum Rate" в `100`.
Если за секунду поступит более 100 запросов, дополнительные запросы будут направлены в `rate exceeded` вместо `success`.
====


=== Отклонять запросы, которые превышают определенную скорость, позволяя для всплесков


NOTE: 



Ключевые слова::
ограничение
лимит
замедлить
скорость запроса



.Конфигурация
====
Установите "Rate Control Criteria" в `flowfile count`.
Установите свойство "Time Duration" на `1 min`.
Настройте свойство "Rate Exceeded Strategy", чтобы указать `Route to 'rate exceeded'`.
Настройте свойство "Maximum Rate", чтобы указать, сколько запросов должно проходить каждую минуту.

Например, для разрешения 100 запросов в секунду установите "Maximum Rate" в `6000`.
Это позволит передавать 6000 FlowFiles в минуту, что в среднем составляет 100 FlowFiles в секунду. Однако эти 6000 FlowFiles могут поступить всего за первые несколько секунд или равномерно распределиться на протяжении 60 секунд. В результате получаем среднюю скорость 100 FlowFiles в секунду, но позволяет большим всплескам данных.
Если за минуту поступит более 6000 запросов, дополнительные запросы будут направлены в `rate exceeded` вместо `success`.
====






