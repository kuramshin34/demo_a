= CaptureChangeMySQL 2.2.0

Извлекает события изменения данных (Change Data Capture, CDC) из базы данных MySQL. События CDC включают операции INSERT, UPDATE и DELETE. События выводятся группами указанного количества событий по умолчанию (1, так что каждое событие становится отдельным потоком данных) или группируются как полная транзакция (BEGIN до COMMIT). Все события упорядочены по времени выполнения операции. Примечание: Если процессор останавливается до того, как в поток данных будет записано указанное количество событий, частичный поток данных будет выведен, чтобы обеспечить согласованность потока событий.

[horizontal]
*Tags* (Ключевые слова):
cdc, event, jdbc, mysql, sql, transaction
[horizontal]
*Input Requirement* (Требования к вводу данных):
FORBIDDEN
[horizontal]
*Supports Sensitive Dynamic* (Поддержка динамически изменяемых параметров, которые могут содержать конфиденциальную информацию):
 False (Нет) 



== Properties (Свойства)


.Capture-Change-Mysql-Hosts
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: MySQL Узлы

[horizontal]
*DESCRIPTION (Описание):*:: Список имен хостов (и необязательный порт) записей, соответствующих узлам в кластере MySQL. Записи должны быть разделены запятыми с двоеточием (если необходимо указать порт), например host1:port,host2:port,... Например mysql.myhost.com:3306. Порт не обязательно указывать, если он не указан, будет использоваться значение порта по умолчанию 3306. Этот процессор попытается подключиться к хостам в списке в порядке. Если один из узлов выходит из строя и для кластера включена отработка отказа, то процессор подключится к активному узлу (предполагая, что его запись указана в этом свойстве).


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: 
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Capture-Change-Mysql-Driver-Class*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: MySQL Driver Class Name (Имя класса драйвера MySQL)

[horizontal]
*DESCRIPTION (Описание):*:: The class name of the MySQL database driver class (Имя класса базы данных MySQL драйвера)


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: 
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Capture-Change-Mysql-Driver-Locations
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: MySQL Driver Location(s) (Местоположение драйвера MySQL)

[horizontal]
*DESCRIPTION (Описание):*:: Список, разделенный запятыми, файлов/папок и/или URL-адресов, содержащих JAR-файл и его зависимости для MySQL драйвера (если таковые имеются). Например '/var/tmp/mysql-connector-java-5.1.38-bin.jar'


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Username
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Username (Имя пользователя)

[horizontal]
*DESCRIPTION (Описание):*:: Имя пользователя для доступа к MySQL кластеру


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Password
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Password (Пароль)

[horizontal]
*DESCRIPTION (Описание):*:: Пароль для доступа к MySQL кластеру


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  True (Да) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Events-Per-Flowfile-Strategy*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Event Processing Strategy (Стратегия обработки событий)

[horizontal]
*DESCRIPTION (Описание):*:: Specifies the strategy to use when writing events to FlowFile(s), such as 'Max Events Per FlowFile'


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* Max Events Per FlowFile (Максимальное количество событий на FlowFile): This strategy causes at most the number of events specified in the 'Number of Events Per FlowFile' property to be written per FlowFile. If the processor is stopped before the specified number of events has been written (or the event queue becomes empty), the fewer number of events will still be written as a FlowFile before stopping. 

* One Transaction Per FlowFile (Одна транзакция на FlowFile): This strategy causes each event from a transaction (from BEGIN to COMMIT) to be written to a FlowFile 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Number-Of-Events-Per-Flowfile*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Events Per FlowFile (События на файл)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, сколько событий должно быть записано в один FlowFile. Если процессор останавливается до того, как будет записано указанное количество событий, события все равно будут записаны как FlowFile перед остановкой.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Capture-Change-Mysql-Server-Id
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Server ID (Идентификатор сервера)

[horizontal]
*DESCRIPTION (Описание):*:: Клиент, подключающийся к группе MySQL репликации, является упрощённой репликой (сервером), и значение Server ID должно быть уникальным в рамках всей репликационной группы (то есть отличаться от любых других Server ID, используемых ни для одного из основного или вторичного серверов). Таким образом, каждый экземпляр CaptureChangeMySQL должен иметь уникальный Server ID в рамках репликационной группы. Если Server ID не указан, он по умолчанию устанавливается в 65535.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Db-Name-Pattern
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Database/Schema Name Pattern (Шаблон имени базы данных/схемы)

[horizontal]
*DESCRIPTION (Описание):*:: Регулярное выражение (regex) для сопоставления баз данных (или схем, в зависимости от терминологии вашей СУБД) списку событий CDC. Регулярное выражение должно соответствовать имени базы данных так, как оно хранится в СУБД. Если свойство не установлено, имя базы данных не будет использоваться для фильтрации событий CDC. Примечание: даже если DDL-события влияют на разные базы данных, они связаны с базой данных, используемой сессией для выполнения DDL. Это означает, что если подключение установлено к одной базе данных, но DDL выдается в другой, то подключенная база данных будет той, которая сопоставляется с указанным шаблоном.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Name-Pattern
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Table Name Pattern (Шаблон имени таблицы)

[horizontal]
*DESCRIPTION (Описание):*:: Регулярное выражение (regex) для сопоставления событий CDC, влияющих на соответствующие таблицы. Регулярное выражение должно соответствовать имени таблицы, как оно хранится в базе данных. Если свойство не установлено, события не будут отфильтрованы по имени таблицы.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Capture-Change-Mysql-Max-Wait-Time*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Max Wait Time (Максимальное время ожидания для установления соединения)

[horizontal]
*DESCRIPTION (Описание):*:: Максимальное количество времени, разрешенное для установления соединения, ноль означает, что ограничений нет.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: 
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Capture-Change-Mysql-Dist-Map-Cache-Client
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Distributed Map Cache Client - unused (Распределенный кэш карты - неиспользуемый)

[horizontal]
*DESCRIPTION (Описание):*:: Это устаревшее свойство, которое больше не используется для хранения информации о таблицах, процессор будет обрабатывать информацию о таблицах (названия столбцов, типы и т.д.)


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Capture-Change-Mysql-Retrieve-All-Records*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Retrieve All Records (Извлечь все записи)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, следует ли получить все доступные события CDC, независимо от текущего имени файла бинога и/или позиции. Если в состоянии процессора присутствуют значения имени файла бинога и позиции, значение этого свойства игнорируется. Это позволяет настроить 4 различных конфигурации: 1) Если бинлог-данные доступны в состоянии процессора, они используются для определения начального положения, и значение Retrieve All Records игнорируется. 2) Если бинлог-данных нет в состоянии процессора, то установка Retrieve All Records в true означает начало с начала истории бинога. 3) Если бинлог-данных нет в состоянии процессора и Initial Binlog Filename/Position не установлены, то установка Retrieve All Records в false означает начало с конца истории бинога. 4) Если бинлог-данных нет в состоянии процессора и Initial Binlog Filename/Position установлены, то установка Retrieve All Records в false означает начало с указанного начального файла бинога/позиции. Для сброса поведения откройте состояние процессора (обратитесь к разделу State Management документации процессора).


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Capture-Change-Mysql-Include-Begin-Commit*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Include Begin/Commit Events (Включить события BEGIN или COMMIT)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, следует ли выпускать события, соответствующие событию BEGIN или COMMIT в двоичном журнале. Установите значение true, если необходимы события BEGIN/COMMIT в downstream flow, иначе установите false, что подавляет генерацию этих событий и может увеличить производительность потока.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.*Capture-Change-Mysql-Include-Ddl-Events*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Include DDL Events (Включить события DDL)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, следует ли испускать события, соответствующие языку определений данных (DDL), таким как ALTER TABLE, TRUNCATE TABLE и т.д., в двоичном логе. Установите значение true, если необходимы/необходимы события DDL в потоке ниже, в противном случае установите значение false, что подавляет генерацию этих событий и может увеличить производительность потока.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Capture-Change-Mysql-Init-Seq-Id
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Initial Sequence ID (Начальный идентификатор последовательности)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает начальный идентификатор последовательности, который следует использовать, если состояние этого процессора не имеет текущего идентификатора последовательности. Если идентификатор последовательности присутствует в состоянии процессора, это свойство игнорируется. Идентификаторы последовательностей являются монотонно возрастающими целыми числами, которые регистрируют порядок потоков данных, генерируемых процессором. Они могут быть использованы с процессором EnforceOrder для обеспечения упорядоченной доставки событий CDC.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Init-Binlog-Filename
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Initial Binlog Filename (Начальное имя бинарного файла)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает начальное имя бинарного файла для использования, если состояние этого процессора не имеет текущего имени бинарного файла. Если в состоянии процессора или свойстве "Использовать GTID" установлено значение false, это свойство игнорируется. Это может быть использовано вместе с Initial Binlog Position для пропуска предыдущих событий, если они не нужны. Обратите внимание, что поддерживается язык выражений NiFi, но это свойство оценивается при настройке процессора, поэтому атрибуты FlowFile могут не использоваться. Поддерживается язык выражений для включения использования переменных окружения.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.Capture-Change-Mysql-Init-Binlog-Position
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Initial Binlog Position (Начальная позиция бинарного лога)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает начальное смещение в бинарном логе (указанном по Initial Binlog Filename) для использования, если состояние этого процессора не имеет текущего имени файла бинарного лога. Если имя файла присутствует в состоянии процессора или свойство "Use GTID" равно false, это свойство игнорируется. Это может быть использовано вместе с Initial Binlog Filename для пропуска событий, если не нужны предыдущие события. Обратите внимание, что поддерживается язык выражений NiFi, но это свойство оценивается при настройке процессора, поэтому атрибуты FlowFile не могут быть использованы. Поддерживается язык выражений для включения использования переменных окружения.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Environment variables defined at JVM level and system properties (Переменные окружения, определенные на уровне JVM и системных свойств)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Capture-Change-Mysql-Use-Gtid*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Use Binlog GTID (Использовать бинарный лог с GTID)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает, следует ли использовать глобальный идентификатор транзакции (GTID) для отслеживания бинарного лога. Если установлено в true, состояние процессора имен файла и позиции бинарного лога игнорируются. Основное преимущество использования GTID заключается в более надежном откате по сравнению с использованием имени файла/позиции бинарного лога.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* true

* false


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Capture-Change-Mysql-Init-Gtid
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: Initial Binlog GTID (Начальный бинлог GTID)

[horizontal]
*DESCRIPTION (Описание):*:: Указывает начальный GTID для использования, если состояние этого процессора не имеет текущего GTID. Если в состоянии процессора или свойстве "Использовать GTID" установлено значение false, это свойство игнорируется. Это может быть использовано для пропуска событий, если не нужны предыдущие события. Обратите внимание, что поддерживается язык выражений NiFi, но это свойство оценивается при настройке процессора, поэтому атрибуты FlowFile не могут быть использованы. Поддерживается язык выражений для включения использования переменных окружения.


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: 
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************
.*Ssl Mode*
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: SSL Mode (Режим SSL)

[horizontal]
*DESCRIPTION (Описание):*:: Режим SSL, используемый при настройке службы контекста SSL, поддерживающего опции проверки сертификата


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*ALLOWABLE VALUES (Допустимые значения):*::

* DISABLED (Отключено): Подключение без использования TLS 

* PREFERRED (Предпочтительно): Подключение с использованием TLS, если сервер поддерживает его, в противном случае подключение без TLS 

* REQUIRED (Требуется): Подключение с использованием TLS или отказ при отсутствии поддержки сервера 

* VERIFY_IDENTITY (Проверка идентичности): Подключение с использованием TLS или отказ при отсутствии поддержки сервера. Проверка соответствия имени хоста, указанного в сертификате X.509, или отказ при несоответствии 


[horizontal]
*REQUIRED (Обязательный параметр):*::  True (Да) 
************************************************
.Ssl Context Service
************************************************
[horizontal]
*DISPLAY NAME (Отображаемое наименование):*:: SSL Context Service (SSL Контекст Сервиса)

[horizontal]
*DESCRIPTION (Описание):*:: SSL Context Service поддерживающий зашифрованный сокетный обмен


[horizontal]
*EXPRESSION LANGUAGE SCOPE (Область видимости языка выражений):*:: Not Supported (Не поддерживается)
[horizontal]
*SENSITIVE (Содержит конфиденциальные данные):*::  False (Нет) 

[horizontal]
*REQUIRED (Обязательный параметр):*::  False (Нет) 
************************************************




=== Управление состоянием

[cols="1a,2a",options="header",]
|===
|Масштаб |Описание

|
CLUSTER

|Информация, такая как 'указатель' на текущее событие CDC в базе данных, хранится этим процессором, так что он может продолжить с того же места при перезапуске.
|===





=== Ограничения

[cols="1a,2a",options="header",]
|===
|Требуемые права |Объяснение

|
|Расположение драйвера базы данных может ссылаться на ресурсы по протоколу HTTP

|===



=== Relationships (Связи)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`success`
|Успешно создан поток данных из результата набора запросов SQL.

|===





=== Writes Attributes (Записываемые атрибуты)

[cols="1a,2a",options="header",]
|===
|Наименование |Описание

|`cdc.sequence.id`
|Идентификатор последовательности (то есть строго возрастающее целочисленное значение), указывающий порядок потока данных событий относительно других потоков данных событий.

|`cdc.event.type`
|Строка, указывающая на тип события CDC, которое произошло, включая (но не ограничиваясь) 'begin', 'insert', 'update', 'delete', 'ddl' и 'commit'.

|`mime.type`
|Процессор выводит содержимое потока данных в формате JSON, а атрибуту mime.type устанавливается значение application/json

|===







